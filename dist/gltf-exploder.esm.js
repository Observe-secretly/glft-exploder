/*!
 * gltf-exploder v0.1.0
 * (c) 2026 Your Name
 * Released under the MIT License.
 */
import{Vector3 as e,Box3 as t,Sphere as i,AmbientLight as s,HemisphereLight as n,DirectionalLight as l,Mesh as a}from"three";var o;!function(e){e.RADIAL="radial",e.AXIAL="axial",e.NORMALIZED_RADIAL="normalized_radial",e.SIZE_WEIGHTED="size_weighted",e.HIERARCHICAL="hierarchical",e.FORCE_FIELD="force_field"}(o||(o={}));const r={PROGRESS:{DEFAULT:0,MIN:0,MAX:1,STEP:.01},MULTIPLIER:{DEFAULT:1,MIN:.1,MAX:5,STEP:.1},EXPOSURE:{DEFAULT:2,MIN:.1,MAX:6,STEP:.1},DEFAULT_DURATION:1e3,DEFAULT_MAX_DISTANCE:2,WEIGHTS:{BASE:.5,SCALE:1.5,FORCE_FIELD_OFFSET:.2}};function h(t,i){const s=new e;t.getWorldPosition(s);const n=(new e).subVectors(s,i);if(n.length()<.001){const e=function(e){let t=0;for(let i=0;i<e.length;i++)t=(t<<5)-t+e.charCodeAt(i),t|=0;return Math.abs(t%360)}(t.uuid||"");if(n.set(Math.cos(.017453292519943295*e),Math.sin(.017453292519943295*e),Math.cos(.1*e)),t.parent){const e=t.parent.children.indexOf(t);e>=0&&(n.x+=.2*Math.cos(.7*e),n.y+=.2*Math.sin(.7*e),n.z+=.1*(e%3-1))}}return n.normalize()}function d(e,t,i){return Math.max(t,Math.min(i,e))}class p{constructor(s,n,l,a,d={}){this.progress=r.PROGRESS.DEFAULT,this.multiplier=r.MULTIPLIER.DEFAULT,this.mode=o.RADIAL,this.originalPositions=new Map,this.originalRotations=new Map,this.originalScales=new Map,this.explodeDirections=new Map,this.axialDistances=new Map,this.sizeWeights=new Map,this.hierarchicalDepths=new Map,this.modelRadius=1,this.onProgressChangeCallback=null,this.explodableMeshes=[],this.internalLights=[],this.model=s,this.scene=n,this.camera=l,this.renderer=a,this.options={maxDistance:d.maxDistance??r.DEFAULT_MAX_DISTANCE,duration:d.duration??r.DEFAULT_DURATION,createUI:d.createUI??!0,container:d.container??document.body,uiType:d.uiType??"slider",uiStyle:d.uiStyle??{width:"200px",height:"30px",position:"bottom"},directionStrategy:d.directionStrategy??h,mode:d.mode??o.RADIAL,axialVector:d.axialVector??new e(0,1,0),models:d.models??[],initialModel:d.initialModel??""},this.mode=this.options.mode;const p=(new t).setFromObject(this.model);this.modelCenter=p.getCenter(new e);const c=p.getBoundingSphere(new i);this.modelRadius=c.radius||1,this.saveOriginalTransforms(this.model),this.setupInternalLighting()}setupInternalLighting(){const e=new s(16777215,.4);this.scene.add(e),this.internalLights.push(e);const t=new n(16777215,4473924,.4);this.scene.add(t),this.internalLights.push(t);const i=3*this.modelRadius;[[1,1,1],[1,1,-1],[1,-1,1],[1,-1,-1],[-1,1,1],[-1,1,-1],[-1,-1,1],[-1,-1,-1]].forEach(([e,t,s])=>{const n=new l(16777215,.8);n.position.set(this.modelCenter.x+e*i,this.modelCenter.y+t*i,this.modelCenter.z+s*i),n.target=this.model,this.scene.add(n),this.internalLights.push(n)})}calculateAxialDistances(){const e=this.options.axialVector.clone().normalize(),i=(new t).setFromObject(this.model),s=i.min.dot(e),n=i.max.dot(e),l=Math.abs(n-s),a=l>1e-4?1/l:1;for(const t of this.explodableMeshes){const i=this.originalPositions.get(t);if(i){const s=i.clone().sub(this.modelCenter).dot(e);this.axialDistances.set(t,s*a)}}}saveOriginalTransforms(e){this.traverseAndSave(e),this.calculateAxialDistances(),this.calculateSizeWeights(),this.calculateHierarchicalDepths()}calculateHierarchicalDepths(){let e=0;const t=new Map;for(const i of this.explodableMeshes){let s=0,n=i.parent;for(;n&&n!==this.model;)s++,n=n.parent;t.set(i,s),e=Math.max(e,s)}const i=e>0?1/e:1;for(const[e,s]of t)this.hierarchicalDepths.set(e,r.WEIGHTS.BASE+s*i*r.WEIGHTS.SCALE)}calculateSizeWeights(){let t=0;const i=new Map;for(const s of this.explodableMeshes)if(s instanceof a){const n=s.geometry;n.boundingBox||n.computeBoundingBox();const l=n.boundingBox;if(l){const n=new e;l.getSize(n);const a=n.x*n.y*n.z;i.set(s,a),t=Math.max(t,a)}}const s=t>0?1/t:1;for(const[e,t]of i)this.sizeWeights.set(e,r.WEIGHTS.BASE+t*s*r.WEIGHTS.SCALE)}traverseAndSave(t){if(!t.visible)return;const i=new e;if(t.getWorldPosition(i),this.originalPositions.set(t,i.clone()),t.rotation&&this.originalRotations.set(t,t.rotation.clone()),t.scale&&this.originalScales.set(t,t.scale.clone()),"isMesh"in t&&!0===t.isMesh){this.explodableMeshes.push(t);const e=this.options.directionStrategy(t,this.modelCenter);this.explodeDirections.set(t,e)}t.children.forEach(e=>{this.traverseAndSave(e)})}setProgress(e){this.progress=d(e,r.PROGRESS.MIN,r.PROGRESS.MAX),this.updateExplodedPositions(),this.onProgressChangeCallback&&this.onProgressChangeCallback(this.progress),this.renderer.render(this.scene,this.camera)}updateExplodedPositions(){for(const e of this.explodableMeshes){const t=this.originalPositions.get(e),i=this.explodeDirections.get(e);if(t&&i){const s=this.options.maxDistance*this.progress*this.multiplier,n=t.clone();switch(this.mode){case o.RADIAL:n.add(i.clone().multiplyScalar(s));break;case o.AXIAL:{const t=this.axialDistances.get(e)||0,i=this.options.axialVector.clone().normalize();n.add(i.multiplyScalar(t*this.progress*this.multiplier));break}case o.NORMALIZED_RADIAL:{const e=t.clone().sub(this.modelCenter);n.add(e.multiplyScalar(this.progress*this.multiplier));break}case o.SIZE_WEIGHTED:{const t=this.sizeWeights.get(e)||1;n.add(i.clone().multiplyScalar(s*t));break}case o.HIERARCHICAL:{const t=this.hierarchicalDepths.get(e)||1;n.add(i.clone().multiplyScalar(s*t));break}case o.FORCE_FIELD:{const t=this.originalPositions.get(e);if(t){const e=1/(t.clone().sub(this.modelCenter).length()/this.modelRadius+r.WEIGHTS.FORCE_FIELD_OFFSET);n.add(i.clone().multiplyScalar(s*e))}break}}e.parent&&e.parent.worldToLocal(n),e.position.copy(n)}}}setMode(e){this.mode=e,this.updateExplodedPositions(),this.renderer&&this.scene&&this.camera&&this.renderer.render(this.scene,this.camera)}getMode(){return this.mode}setAxialVector(e){this.options.axialVector.copy(e),this.calculateAxialDistances(),this.updateExplodedPositions(),this.renderer&&this.scene&&this.camera&&this.renderer.render(this.scene,this.camera)}getAxialVector(){return this.options.axialVector}reset(){this.progress=0,this.resetToOriginalPositions(),this.onProgressChangeCallback&&this.onProgressChangeCallback(this.progress)}resetToOriginalPositions(){for(const e of this.explodableMeshes){const t=this.originalPositions.get(e),i=this.originalRotations.get(e),s=this.originalScales.get(e);if(t){const i=t.clone();e.parent&&e.parent.worldToLocal(i),e.position.copy(i)}i&&e.rotation&&e.rotation.set(i.x,i.y,i.z),s&&e.scale&&e.scale.set(s.x,s.y,s.z)}}setProgressChangeCallback(e){this.onProgressChangeCallback=e}setMultiplier(e){this.multiplier=d(e,r.MULTIPLIER.MIN,r.MULTIPLIER.MAX),this.updateExplodedPositions(),this.renderer&&this.scene&&this.camera&&this.renderer.render(this.scene,this.camera)}getMultiplier(){return this.multiplier}getProgress(){return this.progress}getModelCenter(){return this.modelCenter.clone()}getOptions(){return this.options}dispose(){this.reset(),this.originalPositions.clear(),this.originalRotations.clear(),this.originalScales.clear(),this.explodeDirections.clear(),this.explodableMeshes=[],this.onProgressChangeCallback=null}}class c{constructor(e,t,i=r.PROGRESS.DEFAULT,s={}){this.handleSliderChange=e=>{const t=parseFloat(e.target.value);this.onProgressChange(t)},this.handleReset=()=>{this.update(0),this.onProgressChange(0)},this.onProgressChange=t,this.styles={container:"\n      position: absolute;\n      top: 20px;\n      right: 20px;\n      width: 260px;\n      border-radius: 4px;\n      padding: 16px;\n      z-index: 1000;\n      font-family: -apple-system, sans-serif;\n    ",label:"\n      font-size: 12px;\n      margin-bottom: 6px;\n      display: block;\n    ",slider:"\n      width: 100%;\n      height: 4px;\n      cursor: pointer;\n      margin: 8px 0;\n    ",select:"\n      width: 100%;\n      padding: 4px 8px;\n      border: 1px solid rgba(226, 221, 221, 0.86);\n      border-radius: 2px;\n      font-size: 12px;\n      outline: none;\n      margin-bottom: 12px;\n    ",group:"\n      margin-bottom: 16px;\n    ",value:"\n      font-size: 12px;\n      font-weight: 500;\n      float: right;\n    ",button:"\n      padding: 6px 12px;\n      border: 1px solid rgba(226, 221, 221, 0.86);\n      border-radius: 2px;\n      font-size: 12px;\n      cursor: pointer;\n      transition: all 0.2s;\n      outline: none;\n    "},this.element=document.createElement("div");!e||e===document.body||"body"===e?this.applyStyle(this.element,this.styles.container):this.applyStyle(this.element,"\n        width: 100%;\n        background: rgba(0, 0, 0, 0.8);\n        border-radius: 4px;\n        padding: 12px 16px;\n        color: #ffffff;\n        font-family: -apple-system, sans-serif;\n        box-sizing: border-box;\n        display: flex;\n        align-items: center;\n        gap: 12px;\n      "),this.label=document.createElement("label"),this.label.textContent="爆炸视图",this.applyStyle(this.label,this.styles.label),this.element.appendChild(this.label),this.slider=document.createElement("input"),this.slider.type="range",this.slider.min=r.PROGRESS.MIN.toString(),this.slider.max=r.PROGRESS.MAX.toString(),this.slider.step=r.PROGRESS.STEP.toString(),this.slider.value=i.toString(),this.applyStyle(this.slider,this.styles.slider),this.element.appendChild(this.slider),this.resetButton=document.createElement("button"),this.resetButton.textContent="重置",this.applyStyle(this.resetButton,this.styles.button),this.element.appendChild(this.resetButton),this.slider.addEventListener("input",this.handleSliderChange),this.resetButton.addEventListener("click",this.handleReset);const n="string"==typeof e?document.querySelector(e):e;n?n.appendChild(this.element):document.body.appendChild(this.element)}show(){this.element.style.display="block"}hide(){this.element.style.display="none"}update(e){this.slider.value=e.toString()}dispose(){this.slider.removeEventListener("input",this.handleSliderChange),this.resetButton.removeEventListener("click",this.handleReset),this.element.parentNode&&this.element.parentNode.removeChild(this.element)}applyStyle(e,t){const i=t.replace(/\s+/g," ").trim();e.style.cssText=i}}class u{constructor(t,i,s,n,l,a,h,d,p=r.PROGRESS.DEFAULT,c=r.MULTIPLIER.DEFAULT,u=r.EXPOSURE.DEFAULT,g=o.RADIAL,m=new e(0,1,0),x=!0,y=[],S,C={}){this.handleModelChange=e=>{const t=e.target.value;this.onModelChange&&this.onModelChange(t)},this.handleSliderChange=e=>{const t=parseFloat(e.target.value);this.valueDisplay.textContent=`${Math.round(100*t)}%`,this.onProgressChange(t)},this.handleMultiplierChange=e=>{const t=parseFloat(e.target.value);this.multiplierDisplay.textContent=t.toFixed(1),this.onMultiplierChange(t)},this.handleExposureChange=e=>{const t=parseFloat(e.target.value);this.exposureDisplay.textContent=t.toFixed(1),this.onExposureChange&&this.onExposureChange(t)},this.handleModeChange=e=>{const t=e.target.value;this.axialContainer&&(this.axialContainer.style.display=t===o.AXIAL?"flex":"none"),this.onModeChange&&this.onModeChange(t)},this.handleAxialChange=t=>{const i=t.target.value,[s,n,l]=i.split(",").map(Number);this.onAxialChange&&this.onAxialChange(new e(s,n,l))},this.handleHelperToggle=e=>{const t=e.target.checked;this.onHelperVisibilityChange&&this.onHelperVisibilityChange(t)},this.handleReset=()=>{this.update(0),this.onProgressChange(0)},this.handleMax=()=>{this.update(1),this.onProgressChange(1)},this.onProgressChange=i,this.onMultiplierChange=s,this.onExposureChange=n,this.onModeChange=l,this.onAxialChange=a,this.onModelChange=h,this.onHelperVisibilityChange=d,this.styles={container:"\n      position: absolute;\n      top: 20px;\n      right: 20px;\n      width: 260px;\n      border-radius: 4px;\n      padding: 16px;\n      z-index: 1000;\n      font-family: -apple-system, sans-serif;\n    ",label:"\n      font-size: 12px;\n      margin-bottom: 6px;\n      display: block;\n    ",slider:"\n      width: 100%;\n      height: 4px;\n      cursor: pointer;\n      margin: 8px 0;\n    ",select:"\n      width: 100%;\n      padding: 4px 8px;\n      border: 1px solid rgba(226, 221, 221, 0.86);\n      border-radius: 2px;\n      font-size: 12px;\n      outline: none;\n      margin-bottom: 12px;\n    ",group:"\n      margin-bottom: 16px;\n    ",value:"\n      font-size: 12px;\n      font-weight: 500;\n      float: right;\n    ",button:"\n      padding: 6px 12px;\n      border: 1px solid rgba(226, 221, 221, 0.86);\n      border-radius: 2px;\n      font-size: 12px;\n      cursor: pointer;\n      transition: all 0.2s;\n      outline: none;\n    "},this.element=document.createElement("div");const E=!t||t===document.body||"body"===t;E?this.applyStyle(this.element,this.styles.container):this.applyStyle(this.element,"\n        width: 100%;\n        border-radius: 4px;\n        padding: 16px;\n        font-family: -apple-system, sans-serif;\n        box-sizing: border-box;\n      ");const b=document.createElement("h3");b.textContent="模型爆炸视图控制",this.applyStyle(b,"\n      margin: 0 0 16px 0;\n      font-size: 14px;\n      font-weight: 600;\n      text-transform: uppercase;\n      letter-spacing: 0.5px;\n    "),this.element.appendChild(b);const M=document.createElement("div");this.applyStyle(M,`\n      display: flex;\n      flex-direction: column;\n      gap: 15px;\n      ${E?"":"padding-top: 5px;"}\n    `),this.element.appendChild(M),this.modelContainer=document.createElement("div"),this.applyStyle(this.modelContainer,`\n      display: ${y&&y.length>0?"flex":"none"};\n      flex-direction: column;\n      width: 100%;\n    `),M.appendChild(this.modelContainer);const f=document.createElement("label");f.textContent="选择模型:",this.applyStyle(f,this.styles.label),this.modelContainer.appendChild(f),this.modelSelect=document.createElement("select"),this.applyStyle(this.modelSelect,this.styles.select),y.forEach(e=>{const t=document.createElement("option"),i="string"==typeof e?e:e.value,s="string"==typeof e?e.split("/").pop()||e:e.label;t.value=i,t.textContent=s,i===S&&(t.selected=!0),this.modelSelect.appendChild(t)}),this.modelContainer.appendChild(this.modelSelect);const A=document.createElement("div");this.applyStyle(A,"\n      display: flex;\n      flex-direction: column;\n      width: 100%;\n    "),M.appendChild(A);const L=document.createElement("div");this.applyStyle(L,"\n      display: flex;\n      justify-content: space-between;\n      margin-bottom: 5px;\n    "),A.appendChild(L);const v=document.createElement("label");v.textContent="爆炸进度:",this.applyStyle(v,this.styles.label),L.appendChild(v),this.valueDisplay=document.createElement("span"),this.valueDisplay.textContent=`${Math.round(100*p)}%`,this.applyStyle(this.valueDisplay,this.styles.label),L.appendChild(this.valueDisplay),this.slider=document.createElement("input"),this.slider.type="range",this.slider.min=r.PROGRESS.MIN.toString(),this.slider.max=r.PROGRESS.MAX.toString(),this.slider.step=r.PROGRESS.STEP.toString(),this.slider.value=p.toString(),this.applyStyle(this.slider,this.styles.slider),A.appendChild(this.slider);const R=document.createElement("div");this.applyStyle(R,"\n      display: flex;\n      flex-direction: column;\n      width: 100%;\n    "),M.appendChild(R);const I=document.createElement("div");this.applyStyle(I,"\n      display: flex;\n      justify-content: space-between;\n      margin-bottom: 5px;\n    "),R.appendChild(I);const D=document.createElement("label");D.textContent="爆炸系数:",this.applyStyle(D,this.styles.label),I.appendChild(D),this.multiplierDisplay=document.createElement("span"),this.multiplierDisplay.textContent=c.toFixed(1),this.applyStyle(this.multiplierDisplay,this.styles.label),I.appendChild(this.multiplierDisplay),this.multiplierSlider=document.createElement("input"),this.multiplierSlider.type="range",this.multiplierSlider.min=r.MULTIPLIER.MIN.toString(),this.multiplierSlider.max=r.MULTIPLIER.MAX.toString(),this.multiplierSlider.step=r.MULTIPLIER.STEP.toString(),this.multiplierSlider.value=c.toString(),this.applyStyle(this.multiplierSlider,this.styles.slider),R.appendChild(this.multiplierSlider);const P=document.createElement("div");this.applyStyle(P,"\n      display: flex;\n      flex-direction: column;\n      width: 100%;\n    "),M.appendChild(P);const T=document.createElement("div");this.applyStyle(T,"\n      display: flex;\n      justify-content: space-between;\n      margin-bottom: 5px;\n    "),P.appendChild(T);const w=document.createElement("label");w.textContent="渲染亮度:",this.applyStyle(w,this.styles.label),T.appendChild(w),this.exposureDisplay=document.createElement("span"),this.exposureDisplay.textContent=u.toFixed(1),this.applyStyle(this.exposureDisplay,this.styles.label),T.appendChild(this.exposureDisplay),this.exposureSlider=document.createElement("input"),this.exposureSlider.type="range",this.exposureSlider.min=r.EXPOSURE.MIN.toString(),this.exposureSlider.max=r.EXPOSURE.MAX.toString(),this.exposureSlider.step=r.EXPOSURE.STEP.toString(),this.exposureSlider.value=u.toString(),this.applyStyle(this.exposureSlider,this.styles.slider),P.appendChild(this.exposureSlider);const F=document.createElement("div");this.applyStyle(F,"\n      display: flex;\n      flex-direction: column;\n      width: 100%;\n    "),M.appendChild(F);const U=document.createElement("label");U.textContent="爆炸模式:",this.applyStyle(U,this.styles.label),F.appendChild(U),this.modeSelect=document.createElement("select"),this.applyStyle(this.modeSelect,this.styles.select);[{value:o.RADIAL,label:"径向爆炸"},{value:o.AXIAL,label:"轴向分层"},{value:o.NORMALIZED_RADIAL,label:"归一化径向"},{value:o.SIZE_WEIGHTED,label:"尺寸加权"},{value:o.HIERARCHICAL,label:"装配树分级"},{value:o.FORCE_FIELD,label:"力场式爆炸"}].forEach(e=>{const t=document.createElement("option");t.value=e.value,t.textContent=e.label,e.value===g&&(t.selected=!0),this.modeSelect.appendChild(t)}),F.appendChild(this.modeSelect),this.axialContainer=document.createElement("div"),this.applyStyle(this.axialContainer,`\n      display: ${g===o.AXIAL?"flex":"none"};\n      flex-direction: column;\n      width: 100%;\n      margin-top: 10px;\n    `),M.appendChild(this.axialContainer);const O=document.createElement("label");O.textContent="爆炸轴向:",this.applyStyle(O,this.styles.label),this.axialContainer.appendChild(O),this.axialSelect=document.createElement("select"),this.applyStyle(this.axialSelect,this.styles.select);[{value:"0,1,0",label:"Y 轴 (垂直)"},{value:"1,0,0",label:"X 轴 (横向)"},{value:"0,0,1",label:"Z 轴 (纵向)"}].forEach(e=>{const t=document.createElement("option");t.value=e.value,t.textContent=e.label;const i=`${m.x},${m.y},${m.z}`;e.value===i&&(t.selected=!0),this.axialSelect.appendChild(t)}),this.axialContainer.appendChild(this.axialSelect);const k=document.createElement("div");this.applyStyle(k,"\n      display: flex;\n      align-items: center;\n      width: 100%;\n      margin-top: 5px;\n      margin-bottom: 5px;\n    "),M.appendChild(k),this.helperToggle=document.createElement("input"),this.helperToggle.type="checkbox",this.helperToggle.id="helper-visibility-toggle",this.helperToggle.checked=x,this.applyStyle(this.helperToggle,"\n      margin-right: 8px;\n      cursor: pointer;\n    "),k.appendChild(this.helperToggle);const z=document.createElement("label");z.htmlFor="helper-visibility-toggle",z.textContent="显示网格和轴标签",this.applyStyle(z,"\n      font-size: 12px;\n      cursor: pointer;\n      user-select: none;\n    "),k.appendChild(z);const H=document.createElement("div");this.applyStyle(H,"\n      display: flex;\n      justify-content: space-between;\n      margin-top: 5px;\n    "),M.appendChild(H),this.resetButton=document.createElement("button"),this.resetButton.textContent="重置视图",this.applyStyle(this.resetButton,`\n      ${this.styles.button}\n      flex: 1;\n      margin-right: 8px;\n    `),H.appendChild(this.resetButton);const V=document.createElement("button");V.textContent="最大化",this.applyStyle(V,`\n      ${this.styles.button}\n      flex: 1;\n    `),H.appendChild(V),this.slider.addEventListener("input",this.handleSliderChange),this.multiplierSlider.addEventListener("input",this.handleMultiplierChange),this.exposureSlider.addEventListener("input",this.handleExposureChange),this.modeSelect.addEventListener("change",this.handleModeChange),this.modelSelect.addEventListener("change",this.handleModelChange),this.axialSelect.addEventListener("change",this.handleAxialChange),this.helperToggle.addEventListener("change",this.handleHelperToggle),this.resetButton.addEventListener("click",this.handleReset),V.addEventListener("click",this.handleMax);const G="string"==typeof t?document.querySelector(t):t;G?G.appendChild(this.element):document.body.appendChild(this.element)}show(){this.element.style.display="block"}hide(){this.element.style.display="none"}update(e){this.slider.value=e.toString(),this.valueDisplay.textContent=`${Math.round(100*e)}%`}updateMultiplier(e){this.multiplierSlider.value=e.toString(),this.multiplierDisplay.textContent=e.toFixed(1)}updateExposure(e){this.exposureSlider.value=e.toString(),this.exposureDisplay.textContent=e.toFixed(1)}updateMode(e){this.modeSelect.value=e,this.axialContainer&&(this.axialContainer.style.display=e===o.AXIAL?"flex":"none")}updateAxialVector(e){this.axialSelect&&(this.axialSelect.value=`${e.x},${e.y},${e.z}`)}dispose(){this.slider.removeEventListener("input",this.handleSliderChange),this.multiplierSlider.removeEventListener("input",this.handleMultiplierChange),this.exposureSlider.removeEventListener("input",this.handleExposureChange),this.modeSelect.removeEventListener("change",this.handleModeChange),this.modelSelect.removeEventListener("change",this.handleModelChange),this.axialSelect.removeEventListener("change",this.handleAxialChange),this.resetButton.removeEventListener("click",this.handleReset),this.element.parentNode&&this.element.parentNode.removeChild(this.element)}applyStyle(e,t){const i=t.replace(/\s+/g," ").trim();e.style.cssText=i}}var g;function m(t,i,s,n,l,a,h,d,p=r.PROGRESS.DEFAULT,m=r.MULTIPLIER.DEFAULT,x=r.EXPOSURE.DEFAULT,y=o.RADIAL,S=new e(0,1,0),C=!0){if(!1===t.createUI)return null;const E=t.container?function(e){if("string"==typeof e){const t=document.querySelector(e);if(!t)throw new Error(`找不到容器元素: ${e}`);return t}return e}(t.container):document.body;switch(t.uiType||g.SLIDER){case g.PANEL:return new u(E,i,s,n,l,a,h,d,p,m,x,y,S,C,t.models,t.initialModel,t.uiStyle);case g.SLIDER:default:return new c(E,i,p,t.uiStyle)}}!function(e){e.SLIDER="slider",e.PANEL="panel"}(g||(g={}));class x{constructor(e,t,i,s,n={}){this.ui=null,this.renderer=s,this.core=new p(e,t,i,s,n),!1!==n.createUI&&(this.ui=m(n,this.setProgress.bind(this),this.setMultiplier.bind(this),this.setExposure.bind(this),this.setMode.bind(this),this.setAxialVector.bind(this),this.handleModelChange.bind(this),this.handleHelperVisibilityChange.bind(this),r.PROGRESS.DEFAULT,r.MULTIPLIER.DEFAULT,s.toneMappingExposure,this.core.getMode(),this.core.getAxialVector(),!0))}handleModelChange(e){this.onModelChangeCallback&&this.onModelChangeCallback(e)}handleHelperVisibilityChange(e){this.onHelperVisibilityChangeCallback&&this.onHelperVisibilityChangeCallback(e)}setModelChangeCallback(e){this.onModelChangeCallback=e}setHelperVisibilityChangeCallback(e){this.onHelperVisibilityChangeCallback=e}setProgress(e){this.core.setProgress(e),this.ui&&this.ui.update(e)}setMultiplier(e){this.core.setMultiplier(e),this.ui&&this.ui.updateMultiplier&&this.ui.updateMultiplier(e)}setExposure(e){this.renderer&&(this.renderer.toneMappingExposure=e,this.ui&&this.ui.updateExposure&&this.ui.updateExposure(e))}setMode(e){this.core.setMode(e),this.ui&&this.ui.updateMode&&this.ui.updateMode(e)}setAxialVector(e){this.core.setAxialVector(e),this.ui&&this.ui.updateAxialVector&&this.ui.updateAxialVector(e)}reset(){this.core.reset(),this.ui&&(this.ui.update(r.PROGRESS.DEFAULT),this.ui.updateMultiplier&&this.ui.updateMultiplier(r.MULTIPLIER.DEFAULT),this.ui.updateMode&&this.ui.updateMode(o.RADIAL))}setProgressChangeCallback(e){this.core.setProgressChangeCallback(e)}getProgress(){return this.core.getProgress()}showUI(){this.ui&&this.ui.show()}hideUI(){this.ui&&this.ui.hide()}dispose(){this.core.dispose(),this.ui&&(this.ui.dispose(),this.ui=null)}}export{x as GLTFExploder,g as UIType};
//# sourceMappingURL=gltf-exploder.esm.js.map
